var b;
var RangoMax=120;
var RangoMin=80;
function inicio()
{
    ////INICIO BOGOTA/////
    var Order_A1=document.getElementById("Bogota_Order_A1");
    var Delivery_A2=document.getElementById("Bogota_Delivery_A2");
    var Order_B1=document.getElementById("Bogota_Order_B1");
    var Delivery_B2=document.getElementById("Bogota_Delivery_B2");
    var Order_C1=document.getElementById("Bogota_Order_C1");
    var Delivery_C2=document.getElementById("Bogota_Delivery_C2");
    var Order_D1=document.getElementById("Bogota_Order_B1");
    var Delivery_D2=document.getElementById("Bogota_Delivery_D2");
    var Order_E1=document.getElementById("Bogota_Order_E1");
    var Delivery_E2=document.getElementById("Bogota_Delivery_E2");
    var Order_F1=document.getElementById("Bogota_Order_F1");
    var Delivery_F2=document.getElementById("Bogota_Delivery_F2");
    var Order_G1=document.getElementById("Bogota_Order_G1");
    var Delivery_G2=document.getElementById("Bogota_Delivery_G2");
    var Order_H1=document.getElementById("Bogota_Order_H1");
    var Delivery_H2=document.getElementById("Bogota_Delivery_H2");
    var Order_I1=document.getElementById("Bogota_Order_I1");
    var Delivery_I2=document.getElementById("Bogota_Delivery_I2");
    var Order_J1=document.getElementById("Bogota_Order_J1");
    var Delivery_J2=document.getElementById("Bogota_Delivery_J2");
    var Order_K1=document.getElementById("Bogota_Order_K1");
    var Delivery_K2=document.getElementById("Bogota_Delivery_K2");
    var Order_L1=document.getElementById("Bogota_Order_L1");
    var Delivery_L2=document.getElementById("Bogota_Delivery_L2");
    var Order_M1=document.getElementById("Bogota_Order_M1");
    var Delivery_M2=document.getElementById("Bogota_Delivery_M2");
    var Order_N1=document.getElementById("Bogota_Order_N1");
    var Delivery_N2=document.getElementById("Bogota_Delivery_N2");
    var Order_O1=document.getElementById("Bogota_Order_O1");
    var Delivery_O2=document.getElementById("Bogota_Delivery_O2");
    var Order_P1=document.getElementById("Bogota_Order_P1");
    var Delivery_P2=document.getElementById("Bogota_Delivery_P2");
    var Order_Q1=document.getElementById("Bogota_Order_Q1");
    var Delivery_Q2=document.getElementById("Bogota_Delivery_Q2");
    var Order_R1=document.getElementById("Bogota_Order_R1");
    var Delivery_R2=document.getElementById("Bogota_Delivery_R2");
    var Order_S1=document.getElementById("Bogota_Order_S1");
    var Delivery_S2=document.getElementById("Bogota_Delivery_S2");
    var Order_T1=document.getElementById("Bogota_Order_T1");
    var Delivery_T2=document.getElementById("Bogota_Delivery_T2");
    var Order_U1=document.getElementById("Bogota_Order_U1");
    var Delivery_U2=document.getElementById("Bogota_Delivery_U2");
    var Order_V1=document.getElementById("Bogota_Order_V1");
    var Delivery_V2=document.getElementById("Bogota_Delivery_V2");
    var Order_W1=document.getElementById("Bogota_Order_W1");
    var Delivery_W2=document.getElementById("Bogota_Delivery_W2");
    var Order_X1=document.getElementById("Bogota_Order_X1");
    var Delivery_X2=document.getElementById("Bogota_Delivery_X2");
    var Order_Y1=document.getElementById("Bogota_Order_Y1");
    var Delivery_Y2=document.getElementById("Bogota_Delivery_Y2");
    var Order_Z1=document.getElementById("Bogota_Order_Z1");
    var Delivery_Z2=document.getElementById("Bogota_Delivery_Z2");
    var Order_total=document.getElementById("Bogota_Order_total");
    var Delivery_total=document.getElementById("Bogota_Delivery_total");
    var fulfillment_total=document.getElementById("Bogota_fulfillment_total");

    ///FIN////

    ///INICIO VILLAVICENCIO///
    var Order_A1=document.getElementById("Vcio_Order_A1");
    var Delivery_A2=document.getElementById("Vcio_Delivery_A2");
    var Order_B1=document.getElementById("Vcio_Order_B1");
    var Delivery_B2=document.getElementById("Vcio_Delivery_B2");
    var Order_C1=document.getElementById("Vcio_Order_C1");
    var Delivery_C2=document.getElementById("Vcio_Delivery_C2");
    var Order_D1=document.getElementById("Vcio_Order_B1");
    var Delivery_D2=document.getElementById("Vcio_Delivery_D2");
    var Order_E1=document.getElementById("Vcio_Order_E1");
    var Delivery_E2=document.getElementById("Vcio_Delivery_E2");
    var Order_F1=document.getElementById("Vcio_Order_F1");
    var Delivery_F2=document.getElementById("Vcio_Delivery_F2");
    var Order_G1=document.getElementById("Vcio_Order_G1");
    var Delivery_G2=document.getElementById("Vcio_Delivery_G2");
    var Order_H1=document.getElementById("Vcio_Order_H1");
    var Delivery_H2=document.getElementById("Vcio_Delivery_H2");
    var Order_I1=document.getElementById("Vcio_Order_I1");
    var Delivery_I2=document.getElementById("Vcio_Delivery_I2");
    var Order_J1=document.getElementById("Vcio_Order_J1");
    var Delivery_J2=document.getElementById("Vcio_Delivery_J2");
    var Order_K1=document.getElementById("Vcio_Order_K1");
    var Delivery_K2=document.getElementById("Vcio_Delivery_K2");
    var Order_L1=document.getElementById("Vcio_Order_L1");
    var Delivery_L2=document.getElementById("Vcio_Delivery_L2");
    var Order_M1=document.getElementById("Vcio_Order_M1");
    var Delivery_M2=document.getElementById("Vcio_Delivery_M2");
    var Order_N1=document.getElementById("Vcio_Order_N1");
    var Delivery_N2=document.getElementById("Vcio_Delivery_N2");
    var Order_O1=document.getElementById("Vcio_Order_O1");
    var Delivery_O2=document.getElementById("Vcio_Delivery_O2");
    var Order_P1=document.getElementById("Vcio_Order_P1");
    var Delivery_P2=document.getElementById("Vcio_Delivery_P2");
    var Order_Q1=document.getElementById("Vcio_Order_Q1");
    var Delivery_Q2=document.getElementById("Vcio_Delivery_Q2");
    var Order_R1=document.getElementById("Vcio_Order_R1");
    var Delivery_R2=document.getElementById("Vcio_Delivery_R2");
    var Order_S1=document.getElementById("Vcio_Order_S1");
    var Delivery_S2=document.getElementById("Vcio_Delivery_S2");
    var Order_T1=document.getElementById("Vcio_Order_T1");
    var Delivery_T2=document.getElementById("Vcio_Delivery_T2");
    var Order_U1=document.getElementById("Vcio_Order_U1");
    var Delivery_U2=document.getElementById("Vcio_Delivery_U2");
    var Order_V1=document.getElementById("Vcio_Order_V1");
    var Delivery_V2=document.getElementById("Vcio_Delivery_V2");
    var Order_W1=document.getElementById("Vcio_Order_W1");
    var Delivery_W2=document.getElementById("Vcio_Delivery_W2");
    var Order_X1=document.getElementById("Vcio_Order_X1");
    var Delivery_X2=document.getElementById("Vcio_Delivery_X2");
    var Order_Y1=document.getElementById("Vcio_Order_Y1");
    var Delivery_Y2=document.getElementById("Vcio_Delivery_Y2");
    var Order_Z1=document.getElementById("Vcio_Order_Z1");
    var Delivery_Z2=document.getElementById("Vcio_Delivery_Z2");
    var Order_total=document.getElementById("Vcio_Order_total");
    var Delivery_total=document.getElementById("Vcio_Delivery_total");
    var fulfillment_total=document.getElementById("Vcio_fulfillment_total");
    ////FIN VCIO///
    b=document.getElementById("button");
    b.addEventListener("click", fulfillment);
 }

 function fulfillment(){
 	///INICIO BOGOTA////
 	var BogA1=Number(Bogota_Order_A1.value);
 	var BogA2=Number(Bogota_Delivery_A2.value);
 	var BogB1=Number(Bogota_Order_B1.value);
 	var BogB2=Number(Bogota_Delivery_B2.value);
 	var BogC1=Number(Bogota_Order_C1.value);
 	var BogC2=Number(Bogota_Delivery_C2.value);
 	var BogD1=Number(Bogota_Order_D1.value);
 	var BogD2=Number(Bogota_Delivery_D2.value);
 	var BogE1=Number(Bogota_Order_E1.value);
 	var BogE2=Number(Bogota_Delivery_E2.value);
 	var BogF1=Number(Bogota_Order_F1.value);
 	var BogF2=Number(Bogota_Delivery_F2.value);
 	var BogG1=Number(Bogota_Order_G1.value);
 	var BogG2=Number(Bogota_Delivery_G2.value);
 	var BogH1=Number(Bogota_Order_H1.value);
 	var BogH2=Number(Bogota_Delivery_H2.value);
 	var BogI1=Number(Bogota_Order_I1.value);
 	var BogI2=Number(Bogota_Delivery_I2.value);
 	var BogJ1=Number(Bogota_Order_J1.value);
 	var BogJ2=Number(Bogota_Delivery_J2.value);
 	var BogK1=Number(Bogota_Order_K1.value);
 	var BogK2=Number(Bogota_Delivery_K2.value);
 	var BogL1=Number(Bogota_Order_L1.value);
 	var BogL2=Number(Bogota_Delivery_L2.value);
 	var BogM1=Number(Bogota_Order_M1.value);
 	var BogM2=Number(Bogota_Delivery_M2.value);
 	var BogN1=Number(Bogota_Order_N1.value);
 	var BogN2=Number(Bogota_Delivery_N2.value);
 	var BogO1=Number(Bogota_Order_O1.value);
 	var BogO2=Number(Bogota_Delivery_O2.value);
 	var BogP1=Number(Bogota_Order_P1.value);
 	var BogP2=Number(Bogota_Delivery_P2.value);
 	var BogQ1=Number(Bogota_Order_Q1.value);
 	var BogQ2=Number(Bogota_Delivery_Q2.value);
 	var BogR1=Number(Bogota_Order_R1.value);
 	var BogR2=Number(Bogota_Delivery_R2.value);
 	var BogS1=Number(Bogota_Order_S1.value);
 	var BogS2=Number(Bogota_Delivery_S2.value);
 	var BogT1=Number(Bogota_Order_T1.value);
 	var BogT2=Number(Bogota_Delivery_T2.value);
 	var BogU1=Number(Bogota_Order_U1.value);
 	var BogU2=Number(Bogota_Delivery_U2.value);
 	var BogV1=Number(Bogota_Order_V1.value);
 	var BogV2=Number(Bogota_Delivery_V2.value);
 	var BogW1=Number(Bogota_Order_W1.value);
 	var BogW2=Number(Bogota_Delivery_W2.value);
 	var BogX1=Number(Bogota_Order_X1.value);
 	var BogX2=Number(Bogota_Delivery_X2.value);
 	var BogY1=Number(Bogota_Order_Y1.value);
 	var BogY2=Number(Bogota_Delivery_Y2.value);
 	var BogZ1=Number(Bogota_Order_Z1.value);
 	var BogZ2=Number(Bogota_Delivery_Z2.value);
 	var Bogota_Totalorder=Number(Bogota_Order_total.value);
 	var Bogota_TotalDelivery=Number(Bogota_Delivery_total.value);
 	var Bogota_TotalFulfillment=Number(Bogota_Fulfillment_total.value);
 	///FIN BOGOTA///
 	///INICIO VILLAVICENCIO////
 	var VcioA1=Number(Vcio_Order_A1.value);
 	var VcioA2=Number(Vcio_Delivery_A2.value);
 	var VcioB1=Number(Vcio_Order_B1.value);
 	var VcioB2=Number(Vcio_Delivery_B2.value);
 	var VcioC1=Number(Vcio_Order_C1.value);
 	var VcioC2=Number(Vcio_Delivery_C2.value);
 	var VcioD1=Number(Vcio_Order_D1.value);
 	var VcioD2=Number(Vcio_Delivery_D2.value);
 	var VcioE1=Number(Vcio_Order_E1.value);
 	var VcioE2=Number(Vcio_Delivery_E2.value);
 	var VcioF1=Number(Vcio_Order_F1.value);
 	var VcioF2=Number(Vcio_Delivery_F2.value);
 	var VcioG1=Number(Vcio_Order_G1.value);
 	var VcioG2=Number(Vcio_Delivery_G2.value);
 	var VcioH1=Number(Vcio_Order_H1.value);
 	var VcioH2=Number(Vcio_Delivery_H2.value);
 	var VcioI1=Number(Vcio_Order_I1.value);
 	var VcioI2=Number(Vcio_Delivery_I2.value);
 	var VcioJ1=Number(Vcio_Order_J1.value);
 	var VcioJ2=Number(Vcio_Delivery_J2.value);
 	var VcioK1=Number(Vcio_Order_K1.value);
 	var VcioK2=Number(Vcio_Delivery_K2.value);
 	var VcioL1=Number(Vcio_Order_L1.value);
 	var VcioL2=Number(Vcio_Delivery_L2.value);
 	var VcioM1=Number(Vcio_Order_M1.value);
 	var VcioM2=Number(Vcio_Delivery_M2.value);
 	var VcioN1=Number(Vcio_Order_N1.value);
 	var VcioN2=Number(Vcio_Delivery_N2.value);
 	var VcioO1=Number(Vcio_Order_O1.value);
 	var VcioO2=Number(Vcio_Delivery_O2.value);
 	var VcioP1=Number(Vcio_Order_P1.value);
 	var VcioP2=Number(Vcio_Delivery_P2.value);
 	var VcioQ1=Number(Vcio_Order_Q1.value);
 	var VcioQ2=Number(Vcio_Delivery_Q2.value);
 	var VcioR1=Number(Vcio_Order_R1.value);
 	var VcioR2=Number(Vcio_Delivery_R2.value);
 	var VcioS1=Number(Vcio_Order_S1.value);
 	var VcioS2=Number(Vcio_Delivery_S2.value);
 	var VcioT1=Number(Vcio_Order_T1.value);
 	var VcioT2=Number(Vcio_Delivery_T2.value);
 	var VcioU1=Number(Vcio_Order_U1.value);
 	var VcioU2=Number(Vcio_Delivery_U2.value);
 	var VcioV1=Number(Vcio_Order_V1.value);
 	var VcioV2=Number(Vcio_Delivery_V2.value);
 	var VcioW1=Number(Vcio_Order_W1.value);
 	var VcioW2=Number(Vcio_Delivery_W2.value);
 	var VcioX1=Number(Vcio_Order_X1.value);
 	var VcioX2=Number(Vcio_Delivery_X2.value);
 	var VcioY1=Number(Vcio_Order_Y1.value);
 	var VcioY2=Number(Vcio_Delivery_Y2.value);
 	var VcioZ1=Number(Vcio_Order_Z1.value);
 	var VcioZ2=Number(Vcio_Delivery_Z2.value);
 	var Vcio_Totalorder=Number(Vcio_Order_total.value);
 	var Vcio_TotalDelivery=Number(Vcio_Delivery_total.value);
 	var Vcio_TotalFulfillment=Number(Vcio_Fulfillment_total.value);
 	///FIN Villacencio///


 	///INICIO Total BOGOTA///
 	var Bogota_Total_order = BogA1+BogB1+BogC1+BogD1+BogE1+BogF1+BogG1+BogH1+BogI1+BogJ1+BogK1+BogL1+BogM1+BogN1+BogO1+BogP1+BogQ1+BogR1+BogS1+BogT1+BogU1+BogV1+BogW1+BogX1+BogY1+BogZ1;
 	var Bogota_Total_Delivery = BogA2+BogB2+BogC2+BogD2+BogE2+BogF2+BogG2+BogH2+BogI2+BogJ2+BogK2+BogL2+BogM2+BogN2+BogO2+BogP2+BogQ2+BogR2+BogS2+BogT2+BogU2+BogV2+BogW2+BogX2+BogY2+BogZ2;

 	document.getElementById("Bogota_Order_total").value=Bogota_Total_order;
 	document.getElementById("Bogota_Delivery_total").value=Bogota_Total_Delivery;

 	
 	if(Bogota_Total_order>"" && Bogota_Total_Delivery>""){
	var Bogota_TotalFulfillment= (Bogota_Total_Delivery/Bogota_Total_order)*100;
	var Bog= Bogota_TotalFulfillment.toFixed(1);
	document.getElementById("Bogota_Fulfillment_total").value=Bog+"%";
    document.getElementById("Fulfillment_Bogota").value=Bog+"%";

	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_total").className = "test";
        document.getElementById("Fulfillment_Bogota").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_total").className = "test";
        document.getElementById("Fulfillment_Bogota").className = "test";
	}
	
 	}
 	///FIN Total Bogota///

 	///INICIO Total Villavicencio///
 	var Vcio_Total_order = VcioA1+VcioB1+VcioC1+VcioD1+VcioE1+VcioF1+VcioG1+VcioH1+VcioI1+VcioJ1+VcioK1+VcioL1+VcioM1+VcioN1+VcioO1+VcioP1+VcioQ1+VcioR1+VcioS1+VcioT1+VcioU1+VcioV1+VcioW1+VcioX1+VcioY1+VcioZ1;
 	var Vcio_Total_Delivery = VcioA2+VcioB2+VcioC2+VcioD2+VcioE2+VcioF2+VcioG2+VcioH2+VcioI2+VcioJ2+VcioK2+VcioL2+VcioM2+VcioN2+VcioO2+VcioP2+VcioQ2+VcioR2+VcioS2+VcioT2+VcioU2+VcioV2+VcioW2+VcioX2+VcioY2+VcioZ2;

 	document.getElementById("Vcio_Order_total").value=Vcio_Total_order;
 	document.getElementById("Vcio_Delivery_total").value=Vcio_Total_Delivery;

 	
 	if(Vcio_Total_order>"" && Vcio_Total_Delivery>""){
	var Vcio_TotalFulfillment= (Vcio_Total_Delivery/Vcio_Total_order)*100;
	var Vcio= Vcio_TotalFulfillment.toFixed(1);
	document.getElementById("Vcio_Fulfillment_total").value=Vcio+"%";
    document.getElementById("Fulfillment_Vcio").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_total").className = "test";
        document.getElementById("Fulfillment_Vcio").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_total").className = "test";
        document.getElementById("Fulfillment_Vcio").className = "test";
	}
	
 	}
 	///FIN Total Villavicencio///

 	///INICIO CASILLAS Villavicencio///
 	if(VcioA1>"" && VcioA2>""){
	var VcioA3= (VcioA2/VcioA1)*100;
	var Vcio= VcioA3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_A3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_A3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_A3").className = "test";
	}

 	}
 	if(VcioB1>"" && VcioB2>""){
	var VcioB3= (VcioB2/VcioB1)*100;
	var Vcio= VcioB3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_B3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_B3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_B3").className = "test";
	}
 	}
 	if(VcioC1>"" && VcioC2>""){
	var VcioC3= (VcioC2/VcioC1)*100;
	var Vcio= VcioC3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_C3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_C3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_C3").className = "test";
	}
 	}
 	if(VcioD1>"" && VcioD2>""){
	var VcioD3= (VcioD2/VcioD1)*100;
	var Vcio= VcioD3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_D3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_D3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_D3").className = "test";
	}
 	}
 	if(VcioE1>"" && VcioE2>""){
	var VcioE3= (VcioE2/VcioE1)*100;
	var Vcio= VcioE3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_E3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_E3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_E3").className = "test";
	}
 	}
 	if(VcioF1>"" && VcioF2>""){
	var VcioF3= (VcioF2/VcioF1)*100;
	var Vcio= VcioF3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_F3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_F3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_F3").className = "test";
	}
 	}
 	
 	if(VcioG1>"" && VcioG2>""){
	var VcioG3= (VcioG2/VcioG1)*100;
	var Vcio= VcioG3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_G3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_G3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_G3").className = "test";
	}
 	}
 	if(VcioH1>"" && VcioH2>""){
	var VcioH3= (VcioH2/VcioH1)*100;
	var Vcio= VcioH3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_H3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_H3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_H3").className = "test";
	}
 	}
 	if(VcioI1>"" && VcioI2>""){
	var VcioI3= (VcioI2/VcioI1)*100;
	var Vcio= VcioI3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_I3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_I3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_I3").className = "test";
	}
 	}
 	if(VcioJ1>"" && VcioJ2>""){
	var VcioJ3= (VcioJ2/VcioJ1)*100;
	var Vcio= VcioJ3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_J3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_J3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_J3").className = "test";
	}
 	}
 	if(VcioJ1>"" && VcioK2>""){
	var VcioK3= (VcioK2/VcioK1)*100;
	var Vcio= VcioK3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_K3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_K3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_K3").className = "test";
	}
 	}
 	if(VcioL1>"" && VcioL2>""){
	var VcioL3= (VcioL2/VcioL1)*100;
	var Vcio= VcioL3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_L3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_L3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_L3").className = "test";
	}
 	}
 	if(VcioM1>"" && VcioM2>""){
	var VcioM3= (VcioM2/VcioM1)*100;
	var Vcio= VcioM3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_M3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_M3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_M3").className = "test";
	}
 	}
 	if(VcioN1>"" && VcioN2>""){
	var VcioN3= (VcioN2/VcioN1)*100;
	var Vcio= VcioN3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_N3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_N3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_N3").className = "test";
	}
 	}
 	if(VcioO1>"" && VcioO2>""){
	var VcioO3= (VcioO2/VcioO1)*100;
	var Vcio= VcioO3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_O3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_O3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_O3").className = "test";
	}
 	}
 	if(VcioP1>"" && VcioP2>""){
	var VcioP3= (VcioP2/VcioP1)*100;
	var Vcio= VcioP3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_P3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_P3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_P3").className = "test";
	}
 	}
 	if(VcioQ1>"" && VcioQ2>""){
	var VcioQ3= (VcioQ2/VcioQ1)*100;
	var Vcio= VcioQ3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_Q3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_Q3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_Q3").className = "test";
	}
 	}
 	if(VcioR1>"" && VcioR2>""){
	var VcioR3= (VcioR2/VcioR1)*100;
	var Vcio= VcioR3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_R3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_R3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_R3").className = "test";
	}
 	}
 	if(VcioS1>"" && VcioS2>""){
	var VcioS3= (VcioS2/VcioS1)*100;
	var Vcio= VcioS3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_S3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_S3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_S3").className = "test";
	}
 	}
 	if(VcioT1>"" && VcioT2>""){
	var VcioT3= (VcioT2/VcioT1)*100;
	var Vcio= VcioT3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_T3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_T3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_T3").className = "test";
	}
 	}
 	if(VcioU1>"" && VcioU2>""){
	var VcioU3= (VcioU2/VcioU1)*100;
	var Vcio= VcioU3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_U3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_U3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_U3").className = "test";
	}
 	}
 	if(VcioV1>"" && VcioV2>""){
	var VcioV3= (VcioV2/VcioV1)*100;
	var Vcio= VcioV3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_V3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_V3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_V3").className = "test";
	}
 	}
 	if(VcioW1>"" && VcioW2>""){
	var VcioW3= (VcioW2/VcioW1)*100;
	var Vcio=VcioW3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_W3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_W3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_W3").className = "test";
	}
 	}
 	if(VcioX1>"" && VcioX2>""){
	var VcioX3= (VcioX2/VcioX1)*100;
	var Vcio= VcioX3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_X3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_X3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_X3").className = "test";
	}
 	}
 	if(VcioY1>"" && VcioY2>""){
	var VcioY3= (VcioY2/VcioY1)*100;
	var Vcio= VcioY3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_Y3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_Y3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_Y3").className = "test";
	}
 	}
 	if(VcioZ1>"" && VcioZ2>""){
	var VcioZ3= (VcioZ2/VcioZ1)*100;
	var Vcio= VcioZ3.toFixed(1);
	document.getElementById("Vcio_Fulfillment_Z3").value=Vcio+"%";
	if(Vcio>RangoMax){
		document.getElementById("Vcio_Fulfillment_Z3").className = "test";
	}
	if(Vcio<RangoMin){
		document.getElementById("Vcio_Fulfillment_Z3").className = "test";
	}
 	}
 	///FIN CASILLAS Villavicencio/// 
 	
 	///INICIO CASILLAS Bogota///
 	if(BogA1>"" && BogA2>""){
	var BogA3= (BogA2/BogA1)*100;
	var Bog= BogA3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_A3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_A3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_A3").className = "test";
	}

 	}
 	if(BogB1>"" && BogB2>""){
	var BogB3= (BogB2/BogB1)*100;
	var Bog= BogB3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_B3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_B3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_B3").className = "test";
	}
 	}
 	if(BogC1>"" && BogC2>""){
	var BogC3= (BogC2/BogC1)*100;
	var Bog= BogC3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_C3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_C3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_C3").className = "test";
	}
 	}
 	if(BogD1>"" && BogD2>""){
	var BogD3= (BogD2/BogD1)*100;
	var Bog= BogD3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_D3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_D3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_D3").className = "test";
	}
 	}
 	if(BogE1>"" && BogE2>""){
	var BogE3= (BogE2/BogE1)*100;
	var Bog= BogE3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_E3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_E3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_E3").className = "test";
	}
 	}
 	if(BogF1>"" && BogF2>""){
	var BogF3= (BogF2/BogF1)*100;
	var Bog= BogF3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_F3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_F3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_F3").className = "test";
	}
 	}
 	
 	if(BogG1>"" && BogG2>""){
	var BogG3= (BogG2/BogG1)*100;
	var Bog= BogG3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_G3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_G3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_G3").className = "test";
	}
 	}
 	if(BogH1>"" && BogH2>""){
	var BogH3= (BogH2/BogH1)*100;
	var Bog= BogH3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_H3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_H3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_H3").className = "test";
	}
 	}
 	if(BogI1>"" && BogI2>""){
	var BogI3= (BogI2/BogI1)*100;
	var Bog= BogI3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_I3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_I3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_I3").className = "test";
	}
 	}
 	if(BogJ1>"" && BogJ2>""){
	var BogJ3= (BogJ2/BogJ1)*100;
	var Bog= BogJ3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_J3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_J3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_J3").className = "test";
	}
 	}
 	if(BogJ1>"" && BogK2>""){
	var BogK3= (BogK2/BogK1)*100;
	var Bog= BogK3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_K3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_K3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_K3").className = "test";
	}
 	}
 	if(BogL1>"" && BogL2>""){
	var BogL3= (BogL2/BogL1)*100;
	var Bog= BogL3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_L3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_L3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_L3").className = "test";
	}
 	}
 	if(BogM1>"" && BogM2>""){
	var BogM3= (BogM2/BogM1)*100;
	var Bog= BogM3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_M3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_M3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_M3").className = "test";
	}
 	}
 	if(BogN1>"" && BogN2>""){
	var BogN3= (BogN2/BogN1)*100;
	var Bog= BogN3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_N3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_N3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_N3").className = "test";
	}
 	}
 	if(BogO1>"" && BogO2>""){
	var BogO3= (BogO2/BogO1)*100;
	var Bog= BogO3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_O3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_O3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_O3").className = "test";
	}
 	}
 	if(BogP1>"" && BogP2>""){
	var BogP3= (BogP2/BogP1)*100;
	var Bog= BogP3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_P3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_P3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_P3").className = "test";
	}
 	}
 	if(BogQ1>"" && BogQ2>""){
	var BogQ3= (BogQ2/BogQ1)*100;
	var Bog= BogQ3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_Q3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_Q3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_Q3").className = "test";
	}
 	}
 	if(BogR1>"" && BogR2>""){
	var BogR3= (BogR2/BogR1)*100;
	var Bog= BogR3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_R3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_R3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_R3").className = "test";
	}
 	}
 	if(BogS1>"" && BogS2>""){
	var BogS3= (BogS2/BogS1)*100;
	var Bog= BogS3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_S3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_S3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_S3").className = "test";
	}
 	}
 	if(BogT1>"" && BogT2>""){
	var BogT3= (BogT2/BogT1)*100;
	var Bog= BogT3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_T3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_T3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_T3").className = "test";
	}
 	}
 	if(BogU1>"" && BogU2>""){
	var BogU3= (BogU2/BogU1)*100;
	var Bog= BogU3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_U3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_U3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_U3").className = "test";
	}
 	}
 	if(BogV1>"" && BogV2>""){
	var BogV3= (BogV2/BogV1)*100;
	var Bog= BogV3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_V3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_V3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_V3").className = "test";
	}
 	}
 	if(BogW1>"" && BogW2>""){
	var BogW3= (BogW2/BogW1)*100;
	var Bog= BogW3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_W3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_W3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_W3").className = "test";
	}
 	}
 	if(BogX1>"" && BogX2>""){
	var BogX3= (BogX2/BogX1)*100;
	var Bog= BogX3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_X3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_X3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_X3").className = "test";
	}
 	}
 	if(BogY1>"" && BogY2>""){
	var BogY3= (BogY2/BogY1)*100;
	var Bog= BogY3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_Y3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_Y3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_Y3").className = "test";
	}
 	}
 	if(BogZ1>"" && BogZ2>""){
	var BogZ3= (BogZ2/BogZ1)*100;
	var Bog= BogZ3.toFixed(1);
	document.getElementById("Bogota_Fulfillment_Z3").value=Bog+"%";
	if(Bog>RangoMax){
		document.getElementById("Bogota_Fulfillment_Z3").className = "test";
	}
	if(Bog<RangoMin){
		document.getElementById("Bogota_Fulfillment_Z3").className = "test";
	}
 	}
 	///FIN CASILLAS Bogota/// 

    ///INICIO TOTAL CUMPLIMIENTO///
    var FulfillmentOrder= Bogota_Total_order + Vcio_Total_order;
    var FulfillmentDelivery= Bogota_Total_Delivery + Vcio_Total_Delivery;
    var Fulfillment_total= (FulfillmentDelivery / FulfillmentOrder)*100;
    var total= Fulfillment_total.toFixed(1);
    document.getElementById("Fulfillment_total").value = total+"%";
    if(total>RangoMax){
        document.getElementById("Fulfillment_total").className = "test";
    }
    if(total<RangoMin){
        document.getElementById("Fulfillment_total").className = "test";
    }
    
}

// default settins - this structure can be moved in separate file in multilangual applications
var A_TCALCONF = {
    'cssprefix'  : 'tcal',
    'months'     : ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
    'weekdays'   : ['Do', 'lu', 'Ma', 'Mi', 'Ju', 'Vi', 'Sa'],
    'longwdays'  : ['Domingo', 'Lunes', 'Martes', 'Miercoles', 'Jueves', 'Viernes', 'Sabado'],
    'yearscroll' : true, // show year scroller
    'weekstart'  : 0, // first day of week: 0-Su or 1-Mo
    'prevyear'   : 'Previous Year',
    'nextyear'   : 'Next Year',
    'prevmonth'  : 'Previous Month',
    'nextmonth'  : 'Next Month',
    'format'     : 'm/d/Y' // 'd-m-Y', Y-m-d', 'l, F jS Y'
};

var A_TCALTOKENS = [
     // A full numeric representation of a year, 4 digits
    {'t': 'Y', 'r': '19\\d{2}|20\\d{2}', 'p': function (d_date, n_value) { d_date.setFullYear(Number(n_value)); return d_date; }, 'g': function (d_date) { var n_year = d_date.getFullYear(); return n_year; }},
     // Numeric representation of a month, with leading zeros
    {'t': 'm', 'r': '0?[1-9]|1[0-2]', 'p': function (d_date, n_value) { d_date.setMonth(Number(n_value) - 1); return d_date; }, 'g': function (d_date) { var n_month = d_date.getMonth() + 1; return (n_month < 10 ? '0' : '') + n_month }},
     // A full textual representation of a month, such as January or March
    {'t': 'F', 'r': A_TCALCONF.months.join('|'), 'p': function (d_date, s_value) { for (var m = 0; m < 12; m++) if (A_TCALCONF.months[m] == s_value) { d_date.setMonth(m); return d_date; }}, 'g': function (d_date) { return A_TCALCONF.months[d_date.getMonth()]; }},
     // Day of the month, 2 digits with leading zeros
    {'t': 'd', 'r': '0?[1-9]|[12][0-9]|3[01]', 'p': function (d_date, n_value) { d_date.setDate(Number(n_value)); if (d_date.getDate() != n_value) d_date.setDate(0); return d_date }, 'g': function (d_date) { var n_date = d_date.getDate(); return (n_date < 10 ? '0' : '') + n_date; }},
    // Day of the month without leading zeros
    {'t': 'j', 'r': '0?[1-9]|[12][0-9]|3[01]', 'p': function (d_date, n_value) { d_date.setDate(Number(n_value)); if (d_date.getDate() != n_value) d_date.setDate(0); return d_date }, 'g': function (d_date) { var n_date = d_date.getDate(); return n_date; }},
     // A full textual representation of the day of the week
    {'t': 'l', 'r': A_TCALCONF.longwdays.join('|'), 'p': function (d_date, s_value) { return d_date }, 'g': function (d_date) { return A_TCALCONF.longwdays[d_date.getDay()]; }},
    // English ordinal suffix for the day of the month, 2 characters
    {'t': 'S', 'r': 'st|nd|rd|th', 'p': function (d_date, s_value) { return d_date }, 'g': function (d_date) { n_date = d_date.getDate(); if (n_date % 10 == 1 && n_date != 11) return 'st'; if (n_date % 10 == 2 && n_date != 12) return 'nd'; if (n_date % 10 == 3 && n_date != 13) return 'rd'; return 'th'; }}
    
];

function f_tcalGetHTML (d_date) {

    var e_input = f_tcalGetInputs(true);
    if (!e_input) return;

    var s_pfx = A_TCALCONF.cssprefix,
        s_format = A_TCALCONF.format;

    // today from config or client date
    var d_today = f_tcalParseDate(A_TCALCONF.today, A_TCALCONF.format);
    if (!d_today)
        d_today = f_tcalResetTime(new Date());

    // selected date from input or config or today 
    var d_selected = f_tcalParseDate(e_input.value, s_format);
    if (!d_selected)
        d_selected = f_tcalParseDate(A_TCALCONF.selected, A_TCALCONF.format);
    if (!d_selected)
        d_selected = new Date(d_today);
    
    // show calendar for passed or selected date
    d_date = d_date ? f_tcalResetTime(d_date) : new Date(d_selected);

    var d_firstDay = new Date(d_date);
    d_firstDay.setDate(1);
    d_firstDay.setDate(1 - (7 + d_firstDay.getDay() - A_TCALCONF.weekstart) % 7);

    var a_class, s_html = '<table id="' + s_pfx + 'Controls"><tbody><tr>'
        + (A_TCALCONF.yearscroll ? '<td id="' + s_pfx + 'PrevYear" ' + f_tcalRelDate(d_date, -1, 'y') + ' title="' + A_TCALCONF.prevyear + '"></td>' : '')
        + '<td id="' + s_pfx + 'PrevMonth"' + f_tcalRelDate(d_date, -1) + ' title="' + A_TCALCONF.prevmonth + '"></td><th>'
        + A_TCALCONF.months[d_date.getMonth()] + ' ' + d_date.getFullYear()
        + '</th><td id="' + s_pfx + 'NextMonth"' + f_tcalRelDate(d_date, 1) + ' title="' + A_TCALCONF.nextmonth + '"></td>'
        + (A_TCALCONF.yearscroll ? '<td id="' + s_pfx + 'NextYear"' + f_tcalRelDate(d_date, 1, 'y') + ' title="' + A_TCALCONF.nextyear + '"></td>' : '')
        + '</tr></tbody></table><table id="' + s_pfx + 'Grid"><tbody><tr>';

    // print weekdays titles
    for (var i = 0; i < 7; i++)
        s_html += '<th>' + A_TCALCONF.weekdays[(A_TCALCONF.weekstart + i) % 7] + '</th>';
    s_html += '</tr>' ;

    // print calendar table
    var n_date, n_month, d_current = new Date(d_firstDay);
    while (d_current.getMonth() == d_date.getMonth() ||
        d_current.getMonth() == d_firstDay.getMonth()) {

        s_html +='<tr>';
        for (var n_wday = 0; n_wday < 7; n_wday++) {

            a_class = [];
            n_date  = d_current.getDate();
            n_month = d_current.getMonth();

            if (d_current.getMonth() != d_date.getMonth())
                a_class[a_class.length] = s_pfx + 'OtherMonth';
            if (d_current.getDay() == 0 || d_current.getDay() == 6)
                a_class[a_class.length] = s_pfx + 'Weekend';
            if (d_current.valueOf() == d_today.valueOf())
                a_class[a_class.length] = s_pfx + 'Today';
            if (d_current.valueOf() == d_selected.valueOf())
                a_class[a_class.length] = s_pfx + 'Selected';

            s_html += '<td' + f_tcalRelDate(d_current) + (a_class.length ? ' class="' + a_class.join(' ') + '">' : '>') + n_date + '</td>';
            d_current.setDate(++n_date);
        }
        s_html +='</tr>';
    }
    s_html +='</tbody></table>';

    return s_html;
}

function f_tcalRelDate (d_date, d_diff, s_units) {

    var s_units = (s_units == 'y' ? 'FullYear' : 'Month');
    var d_result = new Date(d_date);
    if (d_diff) {
        d_result['set' + s_units](d_date['get' + s_units]() + d_diff);
        if (d_result.getDate() != d_date.getDate())
            d_result.setDate(0);
    }
    return ' onclick="f_tcalUpdate(' + d_result.valueOf() + (d_diff ? ',1' : '') + ')"';
}

function f_tcalResetTime (d_date) {
    d_date.setMilliseconds(0);
    d_date.setSeconds(0);
    d_date.setMinutes(0);
    d_date.setHours(12);
    return d_date;
}

// closes calendar and returns all inputs to default state
function f_tcalCancel () {
    
    var s_pfx = A_TCALCONF.cssprefix;
    var e_cal = document.getElementById(s_pfx);
    if (e_cal)
        e_cal.style.visibility = '';
    var a_inputs = f_tcalGetInputs();
    for (var n = 0; n < a_inputs.length; n++)
        f_tcalRemoveClass(a_inputs[n], s_pfx + 'Active');
}

function f_tcalUpdate (n_date, b_keepOpen) {

    var e_input = f_tcalGetInputs(true);
    if (!e_input) return;
    
    d_date = new Date(n_date);
    var s_pfx = A_TCALCONF.cssprefix;

    if (b_keepOpen) {
        var e_cal = document.getElementById(s_pfx);
        if (!e_cal || e_cal.style.visibility != 'visible') return;
        e_cal.innerHTML = f_tcalGetHTML(d_date, e_input);
    }
    else {
        e_input.value = f_tcalGenerateDate(d_date, A_TCALCONF.format);
        f_tcalCancel();
    }
}

function f_tcalOnClick () {

    // see if already opened
    var s_pfx = A_TCALCONF.cssprefix;
    var s_activeClass = s_pfx + 'Active';
    var b_close = f_tcalHasClass(this, s_activeClass);

    // close all clalendars
    f_tcalCancel();
    if (b_close) return;

    // get position of input
    f_tcalAddClass(this, s_activeClass);
    
    var n_left = f_getPosition (this, 'Left'),
        n_top  = f_getPosition (this, 'Top') + this.offsetHeight;

    var e_cal = document.getElementById(s_pfx);
    if (!e_cal) {
        e_cal = document.createElement('div');
        e_cal.onselectstart = function () { return false };
        e_cal.id = s_pfx;
        document.getElementsByTagName("body").item(0).appendChild(e_cal);
    }
    e_cal.innerHTML = f_tcalGetHTML(null);
    e_cal.style.top = n_top + 'px';
    e_cal.style.left = (n_left + this.offsetWidth - e_cal.offsetWidth) + 'px';
    e_cal.style.visibility = 'visible';
}

function f_tcalParseDate (s_date, s_format) {

    if (!s_date) return;

    var s_char, s_regexp = '^', a_tokens = {}, a_options, n_token = 0;
    for (var n = 0; n < s_format.length; n++) {
        s_char = s_format.charAt(n);
        if (A_TCALTOKENS_IDX[s_char]) {
            a_tokens[s_char] = ++n_token;
            s_regexp += '(' + A_TCALTOKENS_IDX[s_char]['r'] + ')';
        }
        else if (s_char == ' ')
            s_regexp += '\\s';
        else
            s_regexp += (s_char.match(/[\w\d]/) ? '' : '\\') + s_char;
    }
    var r_date = new RegExp(s_regexp + '$');
    if (!s_date.match(r_date)) return;
    
    var s_val, d_date = f_tcalResetTime(new Date());
    d_date.setDate(1);

    for (n = 0; n < A_TCALTOKENS.length; n++) {
        s_char = A_TCALTOKENS[n]['t'];
        if (!a_tokens[s_char])
            continue;
        s_val = RegExp['$' + a_tokens[s_char]];
        d_date = A_TCALTOKENS[n]['p'](d_date, s_val);
    }
    
    return d_date;
}

function f_tcalGenerateDate (d_date, s_format) {
    
    var s_char, s_date = '';
    for (var n = 0; n < s_format.length; n++) {
        s_char = s_format.charAt(n);
        s_date += A_TCALTOKENS_IDX[s_char] ? A_TCALTOKENS_IDX[s_char]['g'](d_date) : s_char;
    }
    return s_date;
}

function f_tcalGetInputs (b_active) {

    var a_inputs = document.getElementsByTagName('input'),
        e_input, s_rel, a_result = [];

    for (n = 0; n < a_inputs.length; n++) {

        e_input = a_inputs[n];
        if (!e_input.type || e_input.type != 'text')
            continue;

        if (!f_tcalHasClass(e_input, 'tcal'))
            continue;

        if (b_active && f_tcalHasClass(e_input, A_TCALCONF.cssprefix + 'Active'))
            return e_input;

        a_result[a_result.length] = e_input;
    }
    return b_active ? null : a_result;
}

function f_tcalHasClass (e_elem, s_class) {
    var s_classes = e_elem.className;
    if (!s_classes)
        return false;
    var a_classes = s_classes.split(' ');
    for (var n = 0; n < a_classes.length; n++)
        if (a_classes[n] == s_class)
            return true;
    return false;
}

function f_tcalAddClass (e_elem, s_class) {
    if (f_tcalHasClass (e_elem, s_class))
        return;

    var s_classes = e_elem.className;
    e_elem.className = (s_classes ? s_classes + ' ' : '') + s_class;
}

function f_tcalRemoveClass (e_elem, s_class) {
    var s_classes = e_elem.className;
    if (!s_classes || s_classes.indexOf(s_class) == -1)
        return false;

    var a_classes = s_classes.split(' '),
        a_newClasses = [];

    for (var n = 0; n < a_classes.length; n++) {
        if (a_classes[n] == s_class)
            continue;
        a_newClasses[a_newClasses.length] = a_classes[n];
    }
    e_elem.className = a_newClasses.join(' ');
    return true;
}

function f_getPosition (e_elemRef, s_coord) {
    var n_pos = 0, n_offset,
        e_elem = e_elemRef;

    while (e_elem) {
        n_offset = e_elem["offset" + s_coord];
        n_pos += n_offset;
        e_elem = e_elem.offsetParent;
    }

    e_elem = e_elemRef;
    while (e_elem != document.body) {
        n_offset = e_elem["scroll" + s_coord];
        if (n_offset && e_elem.style.overflow == 'scroll')
            n_pos -= n_offset;
        e_elem = e_elem.parentNode;
    }
    return n_pos;
}

function f_tcalInit () {
    
    if (!document.getElementsByTagName)
        return;

    var e_input, a_inputs = f_tcalGetInputs();
    for (var n = 0; n < a_inputs.length; n++) {
        e_input = a_inputs[n];
        e_input.onclick = f_tcalOnClick;
        f_tcalAddClass(e_input, A_TCALCONF.cssprefix + 'Input');
    }
    
    window.A_TCALTOKENS_IDX = {};
    for (n = 0; n < A_TCALTOKENS.length; n++)
        A_TCALTOKENS_IDX[A_TCALTOKENS[n]['t']] = A_TCALTOKENS[n];
}

function f_tcalAddOnload (f_func) {
    if (document.addEventListener) {
        window.addEventListener('load', f_func, false);
    }
    else if (window.attachEvent) {
        window.attachEvent('onload', f_func);
    }
    else {
        var f_onLoad = window.onload;
        if (typeof window.onload != 'function') {
            window.onload = f_func;
        }
        else {
            window.onload = function() {
                f_onLoad();
                f_func();
            }
        }
    }
}
f_tcalAddOnload (f_tcalInit);
	


  